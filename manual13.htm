<html lang="ru"> 
<meta charset="utf-8"/>
  
<html><body>
<h3>[13] ИМПОРТ-ЭКСПОРТ </h3>
Когда вы закончите отрисовку, экспортируйте съёмку и абрисы в вашем любимом формате и скопируйте файлы на компьютер чтобы там звершить создание карты.

В целях безопасности сделайте zip-архив TopoDroid и перенесите его на свой компьютер.
Архив ZIP является полной резервной копией вашей съёмка и всех экспоротированных файлов, он также содержит команду для восстановления данных съёмки и другой информации в базе данных.
Вы можете использовать его, чтобы переместить съёмку в другой аппарат.
После того как вы сохранили zip архив на свой компьютер из него можно излечь все экспортированые данные.<br><p>
  

<b>Внимание</b><br>
Файл zip архива содержит команду которая восстанавливает  базу данных съёмки и всю сопутствующую информацию при открытии через TopoDroid.
Файл zip содержит полный бекап съёмки и может быть перенесен на другое устройство, где из него можно восстановить эту съёмку.
Zip не сработает если архив содержит базу данных устаревшей версии или более новой чем в  TopoDroid на данном устройстве.<br><p>

После того, как вы загрузили zip архив на ваш компьютер и распаковали его, вы можете дооформить карту пещеры в любой программе, к которой вы привыкли. Поддержка других форматов файлов пещерной топосъёмки при импорте  может быть не полной.<br><p>
  
Данные съёмки и zip архив экспортируются из "Окна данных съёмки".<br>
  
Абрисы экспортируются из <u>окна рисования</u> (каждый абрис отдельно) а также из  <u>окна обзора</u> (Все показаные абрисы в один файл).<br>

Zip архивы для импорта помещаются в папку <i>zip</i> подпапка папки "TopoDroid".<br><p>
  
Экспортированные файлы данных и абрисов хранятся в подпапке «out» папки съемки.<br><p>
  
Целевой файл экспорта 3D-моделей выбирается с помощью системного файлового менеджера.<br><p>
  
<!-- 
Файлы для импорта помещаются в папку <i>импорт</i>.<br>
Zip архивы для импорта помещаются в папку <i>zip</i>.<br><p>

<h4>Форматы экспорта по умолчанию</h4>
В TopoDroid есть две опции для выбора форматов экспорта по умолчанию данных топосъёмки и абрисов.
По умолчанию обе установленны на "none", т.е. не экспортировать.
<br><p>

В случае если формат экспорта данных съёмки по умолчанию установлен, TopoDroid экспортирует данные съёмки в указаном формате перед тем как создать zip архив, таким образом включая требуемый формат в выгрузку.<br><p>

В случае если формат экспорта абрисов по умолчанию установлен, абрисы экспортируються в этот формат при каждом закрытии (в добавок к сохранению в бинарный формат TopoDroid).<br>
Для cSurvey поперечные сечения сохраняються в картинку PNG.<br><p 
-->
  
<h4>ИМПОРТ СЪЕМКИ</h4>
TopoDroid может импортировать данные топосъемки из TopoDroid zip архива или внешних форматов экспорта.<br>
Импортировать Zip из внутреннего каталога можно нажав на кнопку  "Импорт" на верхней панели <i>Главного окна</i>.<br>
Доступ к файлам съёмок во внешних форматах осуществляется с помощью системного файлового менеджера.<br><p>
Имя файла не должно содержать двоеточие. ':'.<br><p>
 
TopoDroid может импортировать данные съёмки из следующих форматов: 
  
<ul>
<li>Compass</li>
<li>Survex</li>
<li>Therion Только данные.</li>
<li>VisualTopo</li>
<li>CaveSniper</li>
<li>PocketTopo, включая абрисы</li>
<li>TopoDroid zip архивы</li>
</ul>
  
 Импорт файла невозможен в случае если съёмка с таким же названием уже существует в базе TopoDroid.<br><p>
  
В случае импорта из PocketTopo вместе со съемкой импортирутся и абрисы.
При импорте из форматов, которые поддерживают ЛПВН, они будут преоборазованы в x-splays (отображаются зеленым). 
Это происходит при импорте форматов Compass, VisualTopo и Therion.
TopoDroid импортирует файлы находящиеся в папке "import", а также zip архивы из директории "zip".<br><p>
  
В случае импорта данных содержащих значения ЛПВН, они конвертирубися в x-splays (показаны зеленым).<br><p>

<b>Импорт Zip</b><br>
Импорт zip завершается ошибкой, если zip имеет версию базы данных, которая слишком старая или новее, чем текущая версия в TopoDroid.
Коды ошибок
<ul>
<li>1: ошибка ввода-вывода</li>
<li>2: zip TopoDroid слишком старая версия</li>
<li>3: zip версия базы данных слишком старая</li>
<li>4: zip слишком новая версия базы данных</li>
<li>5: название съёмки отличается от имени файла</li>
<li>6: съёмка уже существует</li>
<li>7: не удалось открыть базу данных</li>
<li>8: zip ошибка SQL</li>
<li>9: ошибка формата числа</li>
<li>10: ошибка формата манифеста</li>
<li>11: манифест не найден</li>
<li>12: ошибка ввода-вывода манифеста</li>
<li>13: Неожиданная ошибка</li>
</ul><br><p>

Внимание, не стандартные цвета сплеев не импортируются если не включена соответствуюшая опция.
<br><p>
  
<b>Импорт Therion</b><br>
Импортированы могут быть только файлы топоданных Therion в формате "normal".<br>
Команда "declination" принимается во внимание: считываемые азимуты корректируются за мангитное склонение.<br>
Полный путь к съемке может быть префиксом к номерам пикетов [T].<br>
TopoDroid не импортирует скрапы Therion.<br><p>

<b>Импорт PocketTopo</b><br>
TopoDroid может имортировать как топоданные так и абрисы.
При импорте цвета элементов PocketTopo конвертируются в условные обозначения TopoDroid (точки и линии).
Соответствие цветов условным знакам может быть изменено в настройках.<br><p>

<b>Импорт Compass</b><br>
TopoDroid може конвертировать импортируемые данные compass из формата <i>normal</i> в формат <i>diving</i> [T], если включена соответствуюшая опция [G].<br><p>

<b>N.B.</b>
Импорт может не сработать (и обвалить приложение) в случае ошибки базы данных, которую TopoDroid не в состоянии перехватить.
В этом случае удалите частично импортированную съёмку и повторите попытку импорта.<br><p>

<h4>ЭКСПОРТ ДАННЫХ ТОПОСЪЁМКИ</h4>

TopoDroid может экспортировать данные съёмок в следующие форматы программ даля обработки топо-данных:
<ul>
<li><a href="#compass">Compass</a></li>
<li><a href="#csurvey">cSurvey</a></li>
<li><a href="#survex">Survex</a></li>
<li><a href="#therion">Therion</a></li>
<li><a href="#trobot">TopoRobot</a></li>
<li><a href="#vtopo">VisualTopo</a></li>
<li><a href="#walls">Walls</a></li>
<li><a href="#ghtopo">GHTopo</a></li>
<li><a href="#polygon">Polygon</a></li>
<li><a href="#topo">Topo</a></li>
</ul>

Кроме того, он экспортирует данные съёмок в виде
<ul>
<li><a href="#csv">CSV</a></li>
<li><a href="#dxf">DXF</a></li>
<li><a href="#kml">KML</a></li>
<li><a href="#gpx">GPX track</a></li>
<li><a href="#shp">shapefile</a></li>
</ul>
Если в съёмке нет географической привязки, последние четыре формата экспорта не отображаются в диалоге экспорта.
<br><p>

Привязанные пикеты экспортируються с координатами в формате широта-долгота [доли градусов] и высота над средним уровнем моря [м].<br><p>
Сплеи, помеченные как Гор./Верт. (ЛПВН)  экспортируются как обычные сплеи. (длина, азимут, угол)<br><p>

Следующие форматы экспорта больше не поддерживаются:
<ul>
<li><a href="">WinKarst</a></li>
<li><a href="">Grottolf</a></li>
<li><a href="">PocketTopo</a></li>
<li><a href="">PLT file (OziExplorer)</a></li>
<li><a href="">GeoJSON</a></li>
</ul>
<br><p>

<b id="compass">Compass</b> (.dat)<br>
<i>Compass</i> формат данных поддерживается как на импорт так и на экспорт.<br>
Импортируемые файлы compass должнв иметь расширение ".dat" либо ".DAT".<br>
Поддерживаются форматы данных "normal" и "diving".<br>
Единицы измерения 'футы' и 'градусы'. (автоматически конвертируются в метры и градусы внутри TopoDroid)<br><p>
  
Настройки:
<ul style="margin-top=0">
<li><u>Префикс пикета</u>: если задан, то добавляется к номерам пикетов</li>
<li><u>Сплеи</u></li>
<li><u>поменять местами лево и право</u></li>
</ul>
<br><p>

<b id="csurvey">cSurvey</b> (.csx)<br>
Файлы экспорта в формате cSurvey требуют версию cSurvey v. 1.20 и выше.<br>
Экспорт в <i>cSurvey</i> выполненный из окна <u>информации о съемке</u> будет содержать только нитку хода, но не абрисы.<br>
Чтобы экспортировать абрис в  <i>cSurvey</i> (план и разрез), нужно выполнить экспорт из <u>окна абрисов</u>.
<br><p>

 Экспорт в <i>cSurvey</i> включает калибровочные замеры и медиа файлы (аудио и фото).<br><p>

 Настройки:<ul style="margin-top=0">
<li><u>префикс пикетов</u> добавлять ли префикс названия съемки к номерам пикетов</li>
</ul><p>

<b id="survex">Survex</b> (.svx)<br>
Данные съёмки могут быть экспортированы в формат <i>Survex</i>.<br>
Единицы измерения данных в соответствии с настройками пользователя.<br><p>
Импортируемые данные Survex должны быть в файле с расширением ".svx".<br>

Настройки:<ul style="margin-top=0">
<li>конец строки может быть либо Unix либо Windows,</li>
<li>боковые замеры могут быть экспортированы с номером пикета ДО (такой же номер как у пикета ОТ с добавлением буквы)</li>
<li>добавить ЛПВН в экспорт</li>
</ul><p>

<b id="therion">Therion</b> (.th)<br>
Данные топосъёмки экспортируются в <i>Therion</i> используя данные в формате "normal".<br>
Название съемки TopoDroid используется в качаесве названия пещеры в Therion, где '_' заменятеся на пробел.<br>
Единицы измерения данных в соответствии с настройками пользователя.<br><p>
 
Имена членов группы топосъёмки включены в экспорт, но команда закоментирована.<br>
Группа съёмки TopoDroid разделяется на несколько команд <i>team</i> в Therion. Для коректного разделения имена съёмщиков должны быть перечислены
пофамильно через запятую с инициалами предшевствующими фамилии. Например запись "A.W. Smith, B. Ford" преобразуется в <i>team "A.W. Smith"</i> и <i>team "B. Ford"</i>.<br><p>
  
Комментарии к пикетам и отметки (фиксированный пикет, нарисованный пикет) записываются до данных нитки хода.<br><p>
замеры лево и право экспортируются с "-" (дефис) в поле пикета "ДО", обычные сплеи экспортируются с "." (точкой).<br><p>
Закоментированные измерения экспортируются закоментированными (#).<br><p>
  
Для разветки нитки хода используется команда "extend &lt;flag&gt;", которая помещается перед замерами, у которых есть флаг разветки "left", "right",
или "vert". Для сплеев, у которых нет флага разветки TopoDroid записывет "# extend auto", в закоментированном виде поскольку,
это (пока что) не является командой Therion.<br><p>

Частичная развертка поддерживается начная с Therion v. 5.2.2 и она корректно экспортируется в случае если установлена.<br><p>

Координаты привязанных пикетов (долгота широта и альтитуда н.у.м.) экспортируються закоментироваными.
Если у точки указны координаты в другой системе (CRS), то они тоже экспортируются, с указанием названия системы (CRS name).<br><p>

Более того команда "input" для файлов th2 и описание карты для каждого scrap добавлены в конец файла, но закоментированы.
Для того что чтобы создать карты в PDF необходимо раскоментировать эти строки.<br><p>

  
Экспорт в <i>Therion</i> включает замеры проверки калибровки в закоментированном виде.<br><p>
  
Настройки:Settings:<ul style="margin-top=0">
<ul>
<li><u>Therion thconfig</u>: если опция активирована, то будет создан thconfig файл с набором простых команд конфигураци Therion.</li>
<li><u>Карты Therion</u>: если эта опция включена, то команды "map" помещаются в th файл до секции нитки хода.</li>
<li><u>ЛПВН"</u> для того чтобы включить ЛПВН в экспорт.</li>
</ul><p>
  
<u>thconfig</u><br>
Сгененрированный "thconfig" содержит базовый набор команд для создания плана и разреза-развертки в формате pdf.<br>
Вы можете сгенерировать простую карту в pdf если откроете экспортированный таким образом .th файл в Xtherion.<br>
Если опция thconfig включена, то набор команд input для абрисов не будет закоментирован при экспорте.<br><p>

Название съёмки в TopoDroid используется в качестве названия пещеры в Therion, где подчеркивание '_' заменяется на пробел.
В экспортированном .th файле можно в последствии изменить название пещеры в атрибуте -title, сохранив при этом оригинальное названеи съёмки.<br>
Группа съёмщиков TopoDroid разделяется на несколько строк в поле Therion <i>team</i>: участники группы должны быть перечислены в виде
инициалов имени и фамилий, Например: строка группы "И.М. Пупкин, В. Петров" бкднт трансформирована в  <i>team "И.М. Пупкин"</i> и <i>team "В. Петров"</i>.<br>
В случае если опция <i>thconfig</i> включена, строки подключенных файлов абрисов .th2 в файле .th будут закоментированы и их нужно раскоментировать и при необходимости исправить.<br><p>
  
Импортируемые файлы терион должны иметь расширение ".th".<br>

Разбор и интерпретация синтаксиса <i>Therion</i> в TopoDroid довольно ограничены. Только данные в формате "normal" могут быть прочитаны. 
Также поддерживаются следующие команды Therion: "units", "flag", "extend", "mark" и "station".<br>
Фиксированные точки ("fix") анализируются, но не учитывается так как "cs" (система координат) не поддерживается.<br><p>


<b id="trobot">TopoRobot</b> (.trb)<br>
Данные съёмки могут быть экспортированы в формат <i>TopoRobot</i>. 
При этом необходимо использовать схему наименования пикеитов <i>TopoRobot</i>. 
Если номера пикетов присвоены как в TopoRobot "серия.номер", то они будут использованы при экспорте.<br><p>

<b id="vtopo">VisualTopo</b> (.tro .trox)<br>
<i>VisualTopo</i> формат данных поддерживаются как на импорт так и на экспорт.<br>
Импортируемые файлы VisualTopo должнв иметь расширение ".tro" либо ".TRO".<br>
Поддерживаются сплеи VisualTopo.<br>
Единицы измерения 'метры' и 'градусы'.<br><p>

Настройки:
<ul style="margin-top=0">
<li><u>Trox</u> формат. По умолчанию данные сохраняются в формат "tro"</li>
<li><u>Cплеи</u></li>
<li><u>ЛПВН на пикете ОТ</u></li>
<li><u>Суффикс пикета</u>: добавляется к номерам пикетов если задан</li>
</ul>
<br><p>

<b id="walls">Walls</b> (.srv)<br>
Данные съёмки могут быть экспортированы в формат <i>Walls</i>.<br>
Единицы измерения данных в соответствии с настройками пользователя.<br><p>

<!-- b id="winkarst">WinKarst</b> (.sur)<br>
Данные съёмки могут быть экспортированы в формат <i>WinKarst</i> (не отлажено).<br><p>
Единицы измерения следуют параметрам пользователя.<br>
Если установлен параметр "Walls splays" сплеи экспортируются с номерами пикетов (как в Compass).
В противном случае они экспортируются как «анонимные точечные замерв» проэцированной длины, (wall-shots).<br>
Вертикальную составляющую этих выстрелов можно высчитать по наклону. See the <i>Walls</i> manual.<br> 
<p -->
  
Settings:<ul style="margin-top=0">
<li><u>Walls splay</u>: экспортировать сплеи как обычные сплеи, "12 12-1", или как wall-shots, "12 -".</li>
</ul>
<br><p>
  
Settings:<ul style="margin-top=0">
<li><u>Префикс пикета</u>: если он задан, то добавляется к номерам пикетов</li>
</ul>
<br><p>

<b id="ptopo">PocketTopo</b> (.top)<br>
TopoDroid поддерживает импорт формата <i>PocketTopo</i>.<br><p>

Экспорт содержит только данные съёмки.<br>
Если наименование пикетов установлено в соответсвии со схемой "TopoRobot" и номера пикетов соответствуют схеме TopoRobot  "серия.номер"
они будут экспортированы без изменений, если выбрана другая схема, то буквы будут конверированы в цифры.
При экспорте названия пикетов с буквенно-цифровыми символами должны быть преобразованы в числовые. В этом случае TopoDroid заменяет каждый символ двумя цифрами. Более точно 'a' преобразуется в '00', 'b' в '01' и т.д., 'A' в '50', 'B' в '51', и т.д.. Любой другой символ (т.е., алфавитно-цифровой) преобразуется в '99'.<br><p>

Импортируемые файлы PocketTopo должнв иметь расширение ".top" либо ".TOP".<br>
При импорте, "outline" и "profile" абрисы импортируються.<br>
<i>PocketTopo</i> использует несколько цветов для дифференциации типов линий.
При импорте используется <a href="page_pt_cmap.htm">преобразование</a> из цветов в типы линий therion_types. Линейные и точечные типы могут быть с определены в настройках.<br><p>

Может случиться так, что импортированный абрис не выровнен на нитку хода. В этом случае вы можете сдвинуть абрис в окне <i>Абрисов</i> чтобы он совпал с ниткой хода.<br><p>

<b id="polygon">Polygon</b> (.cave)<br>
Данные съёмки могут быть экспортированы в формат <i>Polygon</i>. 
Привязанные точки содержат координаты в формате lat-long.<br><p>

<b id="ghtopo">GHTopo</b> (.gtx)<br>
TopoDroid может экспортировать данные съёмки в формат <i>GHTopo</i> (частично отлажено).<br><p>
 
<!-- b id="grottolf">Grottolf</b> (.grt)<br>
TopoDroid может экспортировать данные съёмки в формат <i>Grottolf</i> (неотлажено). 
Если первый пикет привязан к географиеским координатам, то данные экспортируются в этой системе, если нет, то используется локальная система. Сечения на пикетах расчитывается при помощи проекции боковых замеров на вертикальную плоскость, перпендикулярную замеру между пикетами.<br><p -->

<b id="topo">Topo</b> (.cav)<br>
Данные съёмки могут быть экспортированы в формат <i>Topo</i>.<br>
Единицы измерения данных в соответствии с настройками пользователя. 
Координаты привязанных пикетов (долгота широта и альтитуда н.у.м.) экспортируються закоментироваными. 
Также поддерживаються некоторые команды. 
  
 Настройки:(в настройках экспорта"Survex"):
 <ul style="margin-top=0">
 <li>окончание строки может быть либо Unix либо Windows</li>
 </ul><p>
  
<b id="csv">CSV</b> (.csv)<br>
Данные съёмки могут быть экспортированы как список с полями разделенными запятой:
<ul style="margin-top=0">
<li>пикеты "от" и "до"</li>
<li>длинна, азимут, угол</li>
<li>метка (флаг) если задан</li>
<li>ускорение, магнитное поле, магнитный угол</li>
<li>время замера, тип (прибором или вручную), MAC адрес прибора</li>
<li>развертка, флаг, тип замера, статус, коментарий</li>
</ul><br>
Комментарии к пикетам не экспортируются. Краткий заголовок предваряет таблицу данных.<br><p>
  
Сырые данные съёмки могут быть экспортированы в формат CSV. В этом случае каждая строка будет состоять из:
<ul style="margin-top=0">
<li>id замера</li>
<li>пикеты "от" и "до"</li>
<li>длинна, азимут, угол, поврот вдоль оси</li>
<li>ускорение, магнитное поле, магнитный угол</li>
</ul><br>

 Настройки:
<ul style="margin-top=0">
<li><u>сырые данные</u>: экспорт сырых данных измерений</li>
<li><u>разделитель</u>: разделитель полей (запятая, черточка табуляция)</li>
<li><u>EOL</u>: конец строки (lf или cr+lf)</li>
</ul><br><p>

<b id="dxf">DXF</b> (.dxf)<br>
Данные съёмки могут быть экспортированы как 3D DXF (<i>LibreCAD</i>) разделенный на слои
<ul style="margin-top=0">
<li>пикеты</li>
<li>нитка</li>
<li>боковые замеры</li>
</ul><br>
Азимуты коректируются за магнитное склонение<br><p>

<!-- b id="plt">PLT</b> (.plt)<br>
Данные съёмки могут быть экспортированы в файл трека (<i>OziExplorer</i>) если вы задали координаты хотябы одного пикета. 
В случае если часть нитки хода не связана с пикетом имеющим географические координаты, то будет выгружена только часть трека до разрыва. Азимуты коректируются за магнитное склонение.<br><p -->

<b id="kml">KML</b> (.kml)<br>
Данные съёмки могут быть экспортированы в файл KML (<i>GoogleEarth-Keyhole Markup Language</i>) если вы задали координаты  хотябы одного пикета. 
В случае если часть нитки хода не связана с пикетом имеющим географические координаты, то будет выгружена только часть трека до разрыва. Азимуты коректируются за магнитное склонение.<br><p>
  
Настройки:<ul style="margin-top=0">
  
<li><u>пикеты</u></li>
<li><u>боковые замеры</u></li>
</ul>
<br><p>
  
<!--b id="geojson">GeoJSON</b> (.json)<br>
Данные съёмки могут быть экспортированы в файл  GeoJSON (<i>RFC 7946</i>)если вы задали координаты хотябы одного пикета.
Замеры экспортируются как <i>LineString</i>, пикеты как <i>Point</i>. 
В случае если часть нитки хода не связана с пикетом имеющим географические координаты, то в GeoJSON то будет выгружена только часть трека до разрыва.
Азимуты коректируются за магнитное склонение.<br><p -->

Настройки:
<ul style="margin-top=0">
<li><u>stations</u>  экспорт пикетов в файл</li>
<li><u>splays</u> экспорт сплеев в файл</li>
</ul>
<br><p>

<b id="shp">Shapefile</b> (.shp .shx .dbf)<br>
Данные съемки могут быть экспортированы в виде шейп-файла, если есть по крайней мере один геопривязаный пикет.
Данные экспортируются в системе координат WGS84.
Экспортируются два шейп-файла: один для пикетов и второй для линий (отрезки и сплеи).
Экпортированные файлы сохранияются в папку "shp".
Каждый шейп-файл состоит из терх файлов: файл данных (shp), файл индексов (shx) и файл атрибутьв (dbf).
Если в съёмке есть разрыв нитки хода, будет экспортирована только та часть в которой есть привязанный пикет.
Азимуты коректируются за магнитное склонение.<br><p>
Все файлы сжимаются в zip архив и помещаются в папку "shp" с расширнием ".shz".
<br><p>
  
 В DBF шейп-файле "пикетов" содержиться только одно поле "номер пикета".<br><p>
  
DBF файл с "Замерами" содержит поля:
<ul style="margin-top=0">
<li><i>type</i>: либо "замер" либо "сплей"</li>
<li><i>from</i> пикет ОТ</li>
<li><i>to</i> пикет ДО ("-" для сплеев)</li>
<li><i>flag</i> флаг замера в 16 ричном формате: 1-поверхность, 2-дублирующий, 4-закоментированный</li>
<li><i>comment</i> комментарий</li>
</ul><br>
 
 Настройки:
<ul style="margin-top=0">
<li><u>пикеты</u>: экспорт пикетов в файл</li>
<li><u>сплеи</u>: экспорт сплеев в файл</li>
</ul><br><p>
  


<h4>ЭКСПОРТ АБРИСОВ</h4>

TopoDroid может экспортировать абрисы в следующие форматы:
<ul>
<li><a href="#csx">cSurvey</a></li>
<li><a href="#th2">Therion</a></li>
<li><a href="#tunnel">Tunnel</a></li>
<li><a href="#xvi">xtherion</a></li>
<li><a href="#cave3d">Cave3D</a></li>
<li><a href="#dxf2">DXF</a></li>
<!-- li><a href="#png">PNG image</a></li -->
<li><a href="#pdf">PDF file</a></li>
<li><a href="#shp2">shapefile</a></li>
<li><a href="#svg">SVG</a></li>
</ul>


<b id="csx">cSurvey</b> (.csx)<br>
Файлы экспорта в формате cSurvey требуют версию cSurvey v. 1.20 и выше.<br>
Этот экспорт содержит абрисы как плана, так и разреза, а также данные съёмки.
Элементы абрисов распределены по соответствуюшим <i>cSurvey</i> слоям.<br><p>
  
В атрибут cSurvey "пещера" экспортируется название съёмки, а в атрибут "ветка" название абриса (без суфиксов 'p' и 's').

Если в съёмке только один абрис, то это будет полный экспорт вашей работы (за исключением сечений).
Если в съёмке более одного абриса, вы должны экспортировать каждый абрис по отдельности и объединить их в <i>cSurvey</i>.<br><p>

Сегментам нитки хода и боковым замерам, а также элементам абриса присваиваются атрибуты распределния по слоям cSurvey.<br><p>

Настройки:<ul style="margin-top=0">
<li><u>префикс пикеитов</u> добавлять префикс к номерам пикетов</li>
<li><u>шаг точек</u> максимальное расстояние между интерполируемыми точками в плавных линиях</li>
</ul><p>


<b id="th2">Therion</b> (.th2)<br>
<i>Therion</i> это программа для картирования пещер для работы с которой создавался TopoDroid.<br><p>
Абрисы экспортируются в формат Therion каждый файл содержит один абрис (в случае если они экспортированы из  "Окна абрисов")
либо все абрисы могут быть экспортированы в один файл для плана и один файл для разреза (в случае если они экспортированы из окна "Обзорной карты"). В последнем есть скрап для каждого абриса, а также скрапы поперечных сечений
в случае экспортируется отдельный скрап для каждого абриса, а также скрапы поперечных сечений, в случае если включена опция автоматически добавлять точки "сечений".
<br><p>
  
 Названия экспортированых в Therion <i>скрапов</i> состоят из названия съеики, названия абриса и суффикса, либо 'p' для плана, либо 's'для разреза.<br>
Для абрисов состоящих из нескольких частей в название Therion <i>скрапа</i> после первого будет добавлен порядковый номер абриса, начиная с 1.<br>
Для поперечных сечений в Therion названия <i>скрапов</i> состоят из названия съеики, двух буквенного кода 'xx' и номера.<br><p>

При экспорте абриса на котором есть точки поперечных сечений через диалог <u>экспорта</u>, автоматически экспортируются сечения связанные с точкой присутствующей на абрисе.<br><p>

Если абрис содержит не ключенные в набор условных обозначений Therion, вы должны добавить префикс "u:" 
к именам неподдерживаемым  символов перед использованием файла th2.<br><p>
  
Настройки Therion:
<ul style="margin-top=0">
<!-- li>дополнительная точка в линии границ областей.  По умолчанию TopoDroid, в отличии от "xtherion", не добавляет доп точку в конец линии совпадающую с начальной для закрытия полигона области.</li -->
<li>автоматически добавлять точки <u>пикетов</u>. [по умолчанию: вкл].</li>
<li>добавлять боковые замеры в абрис (как линии с типом "splay") [по умолчанию: выкл].</li>
<li>добавить команду xtherion для чтения абриса в формате <u>XVI</u> [по умолчанию: выкл].</li>
<li><u>масштаб</u> при эксспорте. по умолчанию 1:100</li>
<li><u>мин. расстояние между точками</u> минимальное расстояние между точками в полилинии. Промежуточные точки не экспортируются. По умолчанию 0.2 м</li>
</ul><p>
  
Изображения абрисов в формате XVI <i>не</i> экспортируются автоматически вместе с фалами абрисов Therion "th2", даже в случае если команда xtherion на добавления XVI включена, поскольку изображение XVI содержит ту же информацию что и th2 файл.
Эта команда может быть использована для загрузки в xtherion XVI изображеия сделанного в другой программе, либо загрузки XVI содержащего все сплеи при отсутсвиии их в th2 файле, что значительно сокращает время отрисовки.
<br><p>
 
 <!--
 <b>Внимание</b>. Начиная с версии 3.1 TopoDroid хранит свои абрисы только во внутреннем бинарном формате.<br>
Предыдущие версии использовали для сохранения абрисов формат Therion.
Для старых проектов конвертация из Therion в бинарный формат происходит "автоматически" в момент открытия абриса: если TopoDroid не может найти абрис в бинарном формате, он начнет искать Therion файл.<br><p>
 -->

<b id="xvi">Xtherion</b> (.xvi)<br>
Файл "xvi" может быть использован в xtherion в качестве фона для рисования.<br>
Линии типа "стена" показаны красным, "склон" оранжевым,  "сечение" серым, остальные линии коричневым.
Границы областей черным.
Значки точек отрисованы в упрощенном виде.
Подписи поддерживают только латинские буквы и цыфры, а также некоторые знаки ('+', '-', '/', '_', '&gt;', '&lt;', '?').
Другие символы заменяются на символ "неизвестно".<br>
Шаг сетки 1 м.
<br><p>

 Настройки XVI находятся в настройках экспорта Therion:
  <ul style="margin-top=0">
<li><u>сетка</u> добавляется в экспортированный файл (размер ячейки соответствует текущим размерам сетки в абрисе). По умолчанию нет</li>
<li>Рисунок <u>сечения</u>: в случае если точки сечений автоматически добавляются к линиям сечений,
абрисы сечений вставляются в xvi файл в точке "сечения"</li>
<li>При экспорте <u>масштаб</u> по умолчанию 1:100</li>
</ul><p>

<b id="tunnel">Tunnel</b> (.xml)<br>
Абрис может быть экспортирован в формат Tunnel XML. Файлы сохраняются в поддиректорию "tnl".<br>
Следующие типы линий транслируются в формат Tunnel lines: wall, presumed, pit, chimney, and slope. 
Все остальные типы линий трансформируются в тип Tunnel "details".<br>
Линии границ областей трансформируются в тип "filled".<br>
Следующие типы точек транслируются в формат Tunnel points: air-draught, archeo, blocks, clay, column, curtain, flowstone, gradient,
guano, mud, pebbl es, popcorn, sand, soda-straw, stalactite, stalagmite, water, water-flow.
Все остальные типы точек трансформируются в тип Tunnel  "bedrock".<br>
<p> 

<b id="cave3d">Cave3D</b> (.c3d)<br>
Абрисы экспортированные в формат "c3d" могут быть подгружены к 3D модели в Cave3D.<br>
<br><p>

<b id="dxf2">DXF</b> (.dxf)<br>
Абрисы могут быть экспортированы как 2D DXF (<i>LibreCAD</i>) где каждый слой содержит точки, линии и области одного типа в дополнение к слоям данных 3D DXF. <br><p>
Элементы абрисов в 2D DXF лежат на плоскости Z=0.<br><p>

Боковые замеры в экспортированных SVG и DXF файлах могут отличатся от того что было на абрисах TopoDroid поскольку экспорт в DXF использует только нпаправление развертки замера между пикетами,  в то время как на абрисах TopoDroid использует азимут замеров для вычисления направления развертки боковых замеров.<br><p>

Абрисы могут быть экспортированы в DXF <i>9</i> AC1009, <i>12</i> (R13) AC1012 и <i>14</i> (R14) AC1014.
Для DXF-9 области экспортируются в виде границ и не имеют заливки.
<br><p>
  
Настройки:<ul style="margin-top=0">
<li>версия DXF: 9 (dxf-9), 12 (dxf-13), or 14 (dxf-14). По умолчанию "9"</li>
<li><u>масштаб</u> DXF</li>
<li><u>Точки поперечных сечений</u>: в случае если включена опция автоматически добавлять точку сечения к концу линии поперечного сечения, то абрис поперечного сечения будет автоматически добавлен в экспорт и помещен в этут точку.</li>
<li><u>XY reference</u>: вставлять точки XY axes reference</li>
<li><u>пикеты</u>: экспортироват точки пикетов</li>
<li><u>интерполированные кривые</u>: whether to draw cubics as interpolated polylines</li>
<li><u>макс. расстояние между точками</u> максимальное расстояние между интерполируемыми точками на гладких линиях.  По умолчанию 0.2 м</li>
<li><u>префикс пикетов</u> добавлять ли префикс к номерам пикетов</li>
<li>AutoCAD версии: 6 (Acad-9) or 12 (Acad-13). По умолчанию "6"</li>
</ul><p>

<!-- b id="png">PNG</b> (.png)<br>
Растровый формат PNG может быть использован для экспорта абрисов.<br>
Настройки "слоев" влияет на экспорт PNG: только видимые слои будут экспортированы.<br><p>
 
Настройки:<ul style="margin-top=0">
<li>разрешение картинки (1 означает что 1 m = 40 пикселей).  The PNG resolution that fits therion th2 export is 5.0.
Если у системы не достаточно памяти для создания картинки в заданом разрешении, TopoDroid будет понижать разрешение до достижения результата.</li>
<li>цвет фона. Введите три значения между 0 (черный) и 255 (насыщенный) для красного, зеленого, и голубого соответствнно.</li>
<li><u>сетка</u>: экспортировать или нет</li>
<li><u>сплеи</u>: экспортировать или нет</li>
<li><u>пикеты</u>: экспортировать или нет</li>
</ul><p -->

Настройки  "слоев" отражаются в экспорте PNG: если включены слои абрисов, то в PNG экспортируются только элементы видимых слоев.
<br><p>

<b id="pdf">PDF</b> (.pdf)<br>
Абрис может быть экспортирован в PDF файл.<br>
Абрисы в формате PDF предназначены для быстрого обмена результатами съёмки
в формате, который может открыть каждый.<br><p>
  
Файл представляет из себя документ состоящий из одной страницы с белым фоном.
Документ включает только те элементы (пикеты, сплеи, сетку, итд.) которые в данный момент отображаются на экране.<br>
Размер текста подписей, масштабной линейки и пикетов уменьшается на 1/4.
Сетка 1 м не рисуется в масштабе меньше 1:100.
Цвета некоторых объектов (подпись) инвертируются для улучшения видимости.<br><p>

Настройки:<ul style="margin-top=0"
<!-- li><u>цвет фона</u>: установить цвет фона белый, временно.</li -->
<li><u>сплеи</u>: включать или не включать сплеи [не включать]</li>
</ul><p>

Экспорт в PDF это экспериментальный функционал.<br><p>
  
<b id="shp2">Shapefile</b> (.shp)<br>
Абрисы можно экспортировать в виде шейп-файла с пикетами, ниткой и линиями.
Данные экспортируются в системе координат WGS84.
Каждый элемент имеет три файла: файл данных , файл индекса и файл базы данных.
Создается папка, содержащая все файлы.
Все файлы сжимаются в zip архив и помещаются в папку "shp" с расширнием ".shz".
<br><p>
  
Если вы установили географическую привязку хотя бы одного пикета и установили соответствующий флажок в диалоговом окне экспорта,
данные экспортируются в системе отсчета WGS84 и корректируются с учетом магнитного склонения.<br>
В противном случае данные экспортируются в локальной системе координат, и поправка на магнитное склонение не применяется.<br><p>

Файл точек "point" DBF содержит поля
<ul style="margin-top=0">
<li>point <i>name</i></li>
<li><i>orientation</i></li>
<li><i>level</i></li>
<li><i>scrap</i></li>
<li>optional <i>text</i> (обрезается до 128 символов)</li>
</ul><br>

Файл "extra" DBF содержит поля
<ul style="margin-top=0">
<li>point <i>name</i></li>
<li><i>orientation</i></li>
<li><i>level</i></li>
<li><i>scrap</i></li>
<li>optional <i>text</i> (обрезается до 128 символов)</li>
<li><i>file</i></li>
</ul><br>

Файл "line" и "area" DBF содержит поля
<ul style="margin-top=0">
<li><i>type</i> это разделяет типы область и линия</li>
<li>line or area <i>name</i></li>
<li><i>level</i></li>
<li><i>scrap</i></li>
</ul><br>

Файл "station" DBF содержит поля
<ul style="margin-top=0">
<li><i>name</i> of the station</li>
</ul><br>

Файл "shot" DBF содержит поля
<ul style="margin-top=0">
<li><i>type</i>: either "leg" or "splay"</li>
<li><i>from</i> station</li>
<li><i>to</i> station ("-" for splays)</li>
<li>shot <i>flag</i> as hex: 1-surface, 2-duplicate, 4-commented</li>
</ul><br> 
 

<b id="svg">SVG</b> (.svg)<br>
Абрисы могут быть экспортированы как SVG файлы.<br><p>
  
Элементы абриса могут быть организованы в слои: <i>стка</i>, <i>пикеты</i>, <i>замеры</i>, <i>сплеи</i>,
 <i>точки</i>, <i>линии</i> и <i>области</i>.<br>
Эти слои вложены в глобальный слой <i>абриса</i>.<br>
В каждом "scrap" или абрисе есть свои слои <i>точки</i>, <i>линии</i> и <i>бласти</i>.<br>
<br><p>

Масштаб при экспорте 1:100.
<br><p>

В случае если включены классы сплеев, каждому классу будет соответсвовать свой цвет: обычные сплеи - серым,
горизонтальные - светло зееным, вертикальные - светло голубым, сплеи поперечных сечений - голубованым.
Классы сплеев не поддерживаются при экспорте в формат "round-trip".
<br><p>
  
Узор линий, как, например штриховка линии колодец, не экспортируется.<br><p>  
однако направление линии может быть показано при включении опции "Направление линии"<br><p>
  
Настройки:
<ul style="margin-top=0">
<li>SVG <u>программа</u>: либо Inkscape либо Illustrator. Это влияет на параметры масштаба экспортируемого файла.</li>
<li><u>Точки поперечных сечений</u>: в случае если включена опция автоматически добавлять точку сечения к концу линии поперечного сечения, то абрис поперечного сечения будет автоматически добавлен в экспорт и помещен в этут точку.</li>
<li><u>авто нумерация пикетов</u>: если эта опция включена, то все номера пркетов включены в экспорт, если нет, то только пиукты из списка сохраненных пикетов будут включены в экспорт.</li>

<li><u>шаг точек</u> максимальное расстояние между интерполируемыми точками в плавных линиях</li>
<li><u>round-trip</u>: абрисы экспортируются готовыми для  Walls/Compass round-trip. По умолчанию нет</li>
<li><u>сетка</u> рисовать сетку при экспорте (размер ячейки в текущих единицах измерения). По умолчанию нет</li>
<li><u>штрих</u> ориентации линий. По умолчанию нет</li>  
<li><u>толщина</u>: линий, подписей, значков, границ областей, линий сетки и нитки хода</li>
<li><u>размер пикетов</u>: размер шрифта подписей пикетов. По умолчанию 20</li>
 </ul><p>

  
<h4>ЭКСПОРТ КАЛИБРОВКИ</h4>

<a href="page_calib_import.htm">Калибровки</a> можно экспортировать и импортировать в CSV-формате. (.csv)<br><p>

<h4>НАСТРОЙКИ ИМПОРТА/ЭКСПОРТА</h4>
<ul style="margin-top=0">
<li><i>Преобразование цветов PocketTopo</i>: определяет, как преобразовать цвета PocketTopo в стили элементов абриса, для импорта файлов PocketTopo.</li> 
<li><i>Оценить размер Лево/Право</i> при импорте Compass/VisualTopo, По умолчанию ВКЛ.</li>
<li><i>Формат экспорта данных</i>: определяет формат по умолчанию, в который экспортируются данные. Это отображается в диалоге экспорта.</li>
<li><i>Формат экспорта абрисов</i>: определяет формат по умолчанию, в который экспортируются абрисы.  Это отображается в диалоге экспорта.</li>
<li><i>Формат авто экспорта абрисов</i>: определяет формат по умолчанию, в который экспортируются абрисы. Файлы в этом формате автоматически создаются при закрытии абриса. Экспортируемые файлы сохраняются во внутренней папке "out" внутри каталога съёмки. Авто экспорт создает дополнительную нагрузку на систему. [G]</li>
<li><i>Команды карт Therion в первую очередь</i>: определяет стоит ли ставить блок команд карты (map) до или после блока нитки хода.</li>
<li><i>Точки пикетов Therion в абрисе</i>: следует ли автоматически добавлять точки пикетов в сохраняемый файл Therion. Если вы хотите использовать файлы абрисоа в Therion то они должны содержать точки пикетов, чтобы коректно определить их масштаб. Вы можете вручную выбрать какие пикеты добавить в абрис (во время редактирования абриса), или настроить TopoDroid добавить пикеты автоматически. Программа добавит все пикеты, которые "внутри" рисунка (внутри пещеры).</li>
<li><i>Боковые замеры в Therion.</i> Добавлять линии боковых замеров на скарапы Therion. По умолчанию нет</li>
<li><i>Префикс пикетов</i>: следует ли автоматически добавлять название съёмки в качестве префикса пикетов при экспорте в cSurvey.</li>
<li><i>Номера пикетов Toporobot</i>. Экспорт номеров пикетов в стиле Toporobot.</li>
<!--li><i>Мин. угол бок. замера для ЛПВН</i>. Минимальный угол между вектором и боковым замером для расчета ЛПВН при экспорте. По умолчанию 0</li -->
<li><b>Compass/TopoRobot/WinKarst/Polygon/VisualTopo</b>
  <ul>
  <li>минимальный угол между <i>замером и сплеем</i> для вычисления ЛПВН [0.0] Этот параметр также используется в <b>Survex/Therion</b> при необходимости вычисления ЛПВН.</li>
  <li>минимальный наклон сплеев для вычисления расстояний верх/низ в ЛПВН [0]</li>
  <li>максимальный наклон сплеев для вычисления расстояний лево/право ЛПВН [90]</li>
  </ul>
</li> 
<li><i>Развернуть ЛП в Compass</i>. Поменять местами Лево и Право при экспорте в формат Compass при экспорте. Необходимо для корректной работы при съёмке обратными замервми. По умолчанию выкл.</li>
<li><i>Survex пикет для бок. замера</i>: следует ли добавлять пикет ДО к боковым замерам как в Survex</li>
<li><i>Survex окончение строки</i>: либо Unix либо Windows</li>
<li><i>Survex ЛПВН</i>: следует ли добавлять ЛПВН при экспорте в Survex  [по умолчанию нет]</li>
<li><b>SVG</b> target <i>program</i> [Inkscape]</li>
<li><i>Сетка в SVG</i>. Добавить сетку в экспорт SVG. По умолчанию выкл.</li>
<li><i>SVG</i> штрих ориентации линий [no]</li>
<li><i>SVG</i> толщина линий (точек, подписей итд)
<li><i>Пикеты в KML/GeoJSON</i>. Добавить точки пикетов при экспорте данных в формат KML. По умолчанию вкл.</li>
<li><i>Боковые замеры в KML/GeoJSON</i>. Добавить линии боковых замеров при экспорте данных в формат KML. По умолчанию выкл.</li>
<!-- li><i>Масштаб PNG</i>: разрешение файлоа PNG при экспорте абрисов. Может быть число между 1 и 10. Чем выше значение, тем больше изображение (если вы установите его слишком высоко система может не иметь достаточно памяти для создания PNG).</li --> 
<!-- li><i>Цвет фона PNG</i>: вы можете установить цвет фона PNG изображений, указав значения RGB (три целых числа между 0 и 255).</li -->
<li><i>Масштаб DXF</i>: масштаб при экспорте абрисов в DXF.</li>
<li><i>Точки бок. замеров в DXF</i>. Экспортировать конечные точки боковых замеров в файл DXF</li>
<li><i>Версия AutoCAD</i> для экспорта в  DXF: либо 6 (AutoCAD R9) либо 12 (AutoCAD R13). В версии 6 DXF кривые Безье заменяются полилинии. Версия 12 DXF экспортирует как сплайн интерполированные линии, но не без глюков.</li>
</ul><br><p>

<h4>ЭКСПОРТ 3D МОДЕЛИ</h4>
  
Диалог экспорта 3D модели доступен из пункта меню "Экспорт" в окне посмотра 3D.<br><p>

3D модель может быть экспортирована в следующие форматы:
<ul>
<li>glTF (GL transfer format)</li>
<li>CGAL</li>
<li>STL, двоичный или ascii</li>
<li>LAS, двоичный</li>
<li>DXF</li>
<li>KML (в случае если модель привязана к координатам)</li>
<li>Shapefile (в случае если модель привязана к координатам)</li>
</ul><br><p>

Некоторые фокматы поддерживают экспорт слелующих элементов 
<ul>
<li>Пикеты</li>
<li>Сплеи</li>
<li>Стены (если сгенерированы)</li>
<li>Поверхность DEM (если загружена)</li>
</ul><br><p>
  
<h4>ЭКСПОРТ ПРОЕКТА ПЕЩЕРЫ</h4>

Проекты пещер можно экспортировать в формате Therion ".th", или Survex ".svx".<br><p> 

Экспортированный файл содержит список съёмок из которых состоит проект и список
пикетов проасоциированных друг с другом ("equate" команды).<br><p>

<a href="page_finalmap.htm">Финальная карта</a><br>
<p>

<a href="manual12.htm">&lt; Окно обзора</a> |
<a href="manual14.htm">Проект пещеры &gt;</a>

</body></html>

